/**
 * ********** DEPRECATED **********
 * @deprecated use 'npm run build_hashes' instead
 */
let tool = require('../../src/modules/Utils/tool')

let CreateSha3ArrayPlugin = (function () {
  const write = require('write')
  const path = require('path')

  function CreateSha3ArrayPlugin (options) {
    if (options === void 0) {
      options = {}
    }
    this.options = options
  }

  CreateSha3ArrayPlugin.prototype.apply = function (compiler) {
    const _this = this

    compiler.plugin('done', function () {
      const fullPath = path.join(_this.options.path, _this.options.fileName)
      let str = `// File auto-generated by webpack's CreateSha3ArrayPlugin\n`
      str += '/* eslint-disable eol-last */\n'
      // str += '/* eslint-disable comma-dangle */\n'
      str += 'module.exports = [\n'
      let iLenCount = 0
      let lenCount = _this.options.content.length
      _this.options.content.forEach((v, i) => {
        iLenCount++
        // let key = i
        // if (!Number.isFinite(key)) {
        //   key = `'${key}'`
        // }
        let comma = ' '
        if (lenCount !== iLenCount) {
          comma = ','
        }
        str += `  '${tool.hash256(v)}'${comma} // ${i}: ${v}\n`
      })
      str += ']\n'
      str = str.trim()
      write.sync(fullPath, str)
    })
  }

  return CreateSha3ArrayPlugin
})()

module.exports = CreateSha3ArrayPlugin
